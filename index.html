<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MyDesktop - 3D Tunnel Navigation</title>

  <!-- CSS -->
  <link rel="stylesheet" href="css/variables.css">
  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/animations.css">
  <link rel="stylesheet" href="css/components.css">
  <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
  <div id="loading-screen">
    <div class="loading-ring"></div>
  </div>

  <!-- 몽환적인 조명 -->
  <div id="ambient-glow">
    <div class="glow-orb orb-1"></div>
    <div class="glow-orb orb-2"></div>
    <div class="glow-orb orb-3"></div>
    <div class="glow-orb orb-4"></div>
  </div>

  <div id="canvas-container"></div>

  <div id="cards-3d-space"></div>

  <!-- 그리드 스크롤 버튼 -->
  <div id="grid-scroll-controls">
    <button class="grid-scroll-btn" id="grid-scroll-up" title="위로 스크롤">
      <svg viewBox="0 0 24 24" fill="currentColor"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
    </button>
    <button class="grid-scroll-btn" id="grid-scroll-down" title="아래로 스크롤">
      <svg viewBox="0 0 24 24" fill="currentColor"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6z"/></svg>
    </button>
  </div>

  <!-- 캐러셀 인디케이터 -->
  <div class="carousel-dots" id="carousel-dots"></div>

  <div id="section-info">
    <div id="section-title">FAVORITES</div>
    <div id="section-subtitle">Your most used sites</div>
  </div>

  <!-- 검색창 -->
  <div id="search-container">
    <div class="search-box">
      <svg class="search-icon" viewBox="0 0 24 24" fill="currentColor">
        <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
      </svg>
      <input type="text" id="search-input" placeholder="바로가기 검색..." autocomplete="off">
      <kbd class="search-shortcut">/</kbd>
    </div>
    <div class="search-results" id="search-results"></div>
  </div>

  <div id="clock-widget">
    <div class="time" id="clock-time">00:00</div>
    <div class="date" id="clock-date">Loading...</div>
  </div>

  <div id="system-widget">
    <div class="system-row" id="battery-row">
      <span class="system-icon">🔋</span>
      <span class="system-label">Battery</span>
      <div class="system-bar"><div class="system-bar-fill" id="battery-bar"></div></div>
      <span class="system-value" id="battery-value">--%</span>
    </div>
    <div class="system-row">
      <span class="system-icon">⚡</span>
      <span class="system-label">Cores</span>
      <span class="system-value" id="cores-value">--</span>
    </div>
    <div class="system-row" id="network-row">
      <span class="system-icon">📶</span>
      <span class="system-label">Network</span>
      <span class="system-value" id="network-value">--</span>
    </div>
    <div class="system-row" id="memory-row">
      <span class="system-icon">📊</span>
      <span class="system-label">JS Heap</span>
      <div class="system-bar"><div class="system-bar-fill" id="memory-bar"></div></div>
      <span class="system-value" id="memory-value">--MB</span>
    </div>
  </div>

  <div id="weather-widget" title="클릭해서 도시 변경">
    <div class="weather-main">
      <span class="weather-icon" id="weather-icon">🌤️</span>
      <span class="weather-temp" id="weather-temp">--°</span>
    </div>
    <div class="weather-info">
      <span class="weather-desc" id="weather-desc">날씨 로딩...</span>
      <span class="weather-location" id="weather-location">--</span>
    </div>
    <div class="weather-edit-hint">📍 클릭해서 변경</div>
  </div>

  <div id="depth-indicator"></div>

  <div id="scroll-hint">
    <div class="mouse"></div>
    <span>SCROLL TO TRAVEL</span>
  </div>

  <div id="color-bar">
    <span id="color-bar-label">Glow</span>
    <div class="color-bar-options">
      <button class="color-bar-btn gold active" data-theme="gold" title="Gold"></button>
      <button class="color-bar-btn purple" data-theme="purple" title="Purple"></button>
      <button class="color-bar-btn cyan" data-theme="cyan" title="Cyan"></button>
      <button class="color-bar-btn pink" data-theme="pink" title="Pink"></button>
      <button class="color-bar-btn green" data-theme="green" title="Green"></button>
      <button class="color-bar-btn red" data-theme="red" title="Red"></button>
      <button class="color-bar-btn blue" data-theme="blue" title="Blue"></button>
      <button class="color-bar-btn white" data-theme="white" title="White"></button>
    </div>
  </div>

  <div id="sidebar-toggles">
    <button id="layout-toggle-btn" title="그리드/캐러셀 전환">
      <svg id="layout-icon-grid" viewBox="0 0 24 24" fill="currentColor">
        <path d="M4 8h4V4H4v4zm6 12h4v-4h-4v4zm-6 0h4v-4H4v4zm0-6h4v-4H4v4zm6 0h4v-4h-4v4zm6-10v4h4V4h-4zm-6 4h4V4h-4v4zm6 6h4v-4h-4v4zm0 6h4v-4h-4v4z"/>
      </svg>
      <svg id="layout-icon-carousel" viewBox="0 0 24 24" fill="currentColor" style="display:none;">
        <path d="M7 19h10V4H7v15zm-5-2h4V6H2v11zM18 6v11h4V6h-4z"/>
      </svg>
    </button>
    <button id="space-toggle-btn" title="공간 전환">
      <svg id="space-icon-tunnel" viewBox="0 0 24 24" fill="currentColor">
        <path d="M12 2L2 19h20L12 2zm0 4l6.5 11h-13L12 6z"/>
      </svg>
      <svg id="space-icon-warp" viewBox="0 0 24 24" fill="currentColor" style="display:none;">
        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/>
      </svg>
      <svg id="space-icon-aurora" viewBox="0 0 24 24" fill="currentColor" style="display:none;">
        <path d="M12 3c-1.1 0-2 .9-2 2v2c0 1.1.9 2 2 2s2-.9 2-2V5c0-1.1-.9-2-2-2zm-6.5 4c-.83 0-1.5.67-1.5 1.5S4.67 10 5.5 10 7 9.33 7 8.5 6.33 7 5.5 7zm13 0c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5S19.33 7 18.5 7zM6 12c-1.1 0-2 .9-2 2v3c0 1.1.9 2 2 2s2-.9 2-2v-3c0-1.1-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2v3c0 1.1.9 2 2 2s2-.9 2-2v-3c0-1.1-.9-2-2-2zm-6 2c-1.1 0-2 .9-2 2v2c0 1.1.9 2 2 2s2-.9 2-2v-2c0-1.1-.9-2-2-2z"/>
      </svg>
    </button>
    <button id="icon-color-toggle-btn" title="아이콘 색상 전환">
      <svg id="icon-color-brand" viewBox="0 0 24 24" fill="currentColor">
        <path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/>
      </svg>
      <svg id="icon-color-white" viewBox="0 0 24 24" fill="currentColor" style="display:none;">
        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z"/>
      </svg>
    </button>
  </div>

  <div class="bottom-buttons">
    <button class="floating-btn" id="settings-btn">⚙️</button>
    <button class="floating-btn" id="add-btn">+</button>
  </div>

  <div id="settings-menu">
    <div class="settings-item settings-submenu-trigger" id="menu-tunnel">
      <span class="icon"><svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16"><path d="M12 2L2 19h20L12 2zm0 4l6.5 11h-13L12 6z"/></svg></span>
      <span>터널 모양</span>
      <span class="submenu-arrow">›</span>
    </div>
    <div class="settings-item settings-submenu-trigger" id="menu-card-style">
      <span class="icon"><svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14z"/></svg></span>
      <span>카드 스타일</span>
      <span class="submenu-arrow">›</span>
    </div>
    <div class="settings-item" id="menu-categories">
      <span class="icon"><svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16"><path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"/></svg></span>
      <span>카테고리 관리</span>
    </div>
    <div class="settings-item" id="menu-import">
      <span class="icon"><svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg></span>
      <span>북마크 가져오기</span>
    </div>
    <div class="settings-item" id="menu-protocol">
      <span class="icon"><svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"/></svg></span>
      <span>빠른 추가 설정</span>
    </div>
    <div class="settings-divider"></div>
    <div class="settings-item" id="menu-export">
      <span class="icon"><svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg></span>
      <span>데이터 내보내기</span>
    </div>
    <div class="settings-item" id="menu-restore">
      <span class="icon"><svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16"><path d="M9 16h6v-6h4l-7-7-7 7h4v6zm-4 2h14v2H5v-2z"/></svg></span>
      <span>데이터 가져오기</span>
    </div>
    <div class="settings-divider"></div>
    <div class="settings-credits">
      <img src="assets/avatar.png" alt="DogBirds" class="credits-avatar">
      <div class="credits-name">DogBirds</div>
      <div class="credits-tagline">Where imagination takes flight</div>
    </div>
  </div>

  <div id="tunnel-submenu">
    <div class="tunnel-option" data-shape="triangle">
      <span class="shape-icon">△</span>
      <span>삼각형</span>
    </div>
    <div class="tunnel-option" data-shape="circle">
      <span class="shape-icon">○</span>
      <span>원형</span>
    </div>
    <div class="tunnel-option" data-shape="square">
      <span class="shape-icon">□</span>
      <span>사각형</span>
    </div>
    <div class="tunnel-option" data-shape="hexagon">
      <span class="shape-icon">⬡</span>
      <span>육각형</span>
    </div>
    <div class="tunnel-option" data-shape="star">
      <span class="shape-icon">☆</span>
      <span>별</span>
    </div>
    <div class="tunnel-option" data-shape="infinity">
      <span class="shape-icon">∞</span>
      <span>무한</span>
    </div>
  </div>

  <div id="card-style-submenu">
    <div class="card-style-option" data-style="glass">
      <span class="style-preview glass-preview"></span>
      <span>글래스</span>
    </div>
    <div class="card-style-option" data-style="rainbow">
      <span class="style-preview rainbow-preview"></span>
      <span>무지개</span>
    </div>
    <div class="card-style-option" data-style="gradient">
      <span class="style-preview gradient-preview"></span>
      <span>그라데이션</span>
    </div>
    <div class="card-style-option" data-style="dark">
      <span class="style-preview dark-preview"></span>
      <span>다크</span>
    </div>
    <div class="card-style-option" data-style="neon">
      <span class="style-preview neon-preview"></span>
      <span>네온</span>
    </div>
    <div class="card-style-option" data-style="hermes">
      <span class="style-preview hermes-preview"></span>
      <span>헤르메스</span>
    </div>
    <div class="card-style-option" data-style="cyberpunk">
      <span class="style-preview cyberpunk-preview"></span>
      <span>사이버펑크</span>
    </div>
    <div class="card-style-option" data-style="apple">
      <span class="style-preview apple-preview"></span>
      <span>애플</span>
    </div>
  </div>

  <div id="toast">복사됨!</div>

  <!-- 카테고리 관리 모달 -->
  <div class="modal-overlay" id="category-modal">
    <div class="modal category-modal">
      <h2 class="modal-title">카테고리 관리</h2>
      <div class="category-list" id="category-list"></div>
      <button class="add-category-btn" id="add-category-btn">+ 새 카테고리</button>
      <div class="modal-actions">
        <button class="modal-btn secondary" id="category-modal-close">닫기</button>
      </div>
    </div>
  </div>

  <!-- 카테고리 편집 다이얼로그 -->
  <div class="modal-overlay" id="category-edit-dialog">
    <div class="modal">
      <h2 class="modal-title" id="category-edit-title">새 카테고리</h2>
      <div class="modal-field">
        <label>이름</label>
        <input type="text" id="category-name-input" placeholder="CATEGORY">
      </div>
      <div class="modal-field">
        <label>설명</label>
        <input type="text" id="category-subtitle-input" placeholder="Description">
      </div>
      <div class="modal-field">
        <label>아이콘 (이모지)</label>
        <input type="text" id="category-icon-input" placeholder="📁" maxlength="2">
      </div>
      <div class="modal-actions">
        <button class="modal-btn secondary" id="category-edit-cancel">취소</button>
        <button class="modal-btn primary" id="category-edit-save">저장</button>
      </div>
    </div>
  </div>

  <!-- 북마크 가져오기 모달 -->
  <div class="modal-overlay" id="import-modal">
    <div class="modal import-modal">
      <h2 class="modal-title">북마크 가져오기</h2>
      <p class="import-description">Chrome에서 북마크 내보내기한 HTML 파일을 선택하거나 드래그하세요.</p>
      <div class="import-dropzone" id="import-dropzone">
        <div class="dropzone-icon">📥</div>
        <div class="dropzone-text">HTML 파일을 드래그하거나<br>클릭해서 선택</div>
      </div>
      <input type="file" id="bookmark-file" accept=".html" hidden>
      <div class="import-preview" id="import-preview"></div>
    </div>
  </div>

  <!-- 프로토콜 핸들러 설정 모달 -->
  <div class="modal-overlay" id="protocol-modal">
    <div class="modal protocol-modal">
      <h2 class="modal-title">🔗 빠른 추가 설정</h2>
      <p class="protocol-description">
        다른 사이트에서 클릭 한 번으로 MyDesktop에 추가하세요!
      </p>

      <div class="modal-field">
        <label>MyDesktop URL (호스팅 주소)</label>
        <input type="url" id="protocol-base-url" placeholder="https://your-domain.com/mydesktop/">
        <small class="protocol-url-hint">로컬 파일(file://)은 보안상 지원되지 않습니다</small>
      </div>

      <div class="bookmarklet-container" id="bookmarklet-container" style="display:none;">
        <a href="#" id="bookmarklet-link" class="bookmarklet-btn" onclick="return false;">
          ➕ Add to MyDesktop
        </a>
        <div class="bookmarklet-hint">↑ 이 버튼을 북마크바로 드래그!</div>

        <div class="bookmarklet-copy">
          <button class="modal-btn secondary" id="copy-bookmarklet-btn">📋 코드 복사</button>
          <small>드래그가 안 되면 코드를 복사해서 북마크 URL에 붙여넣기</small>
        </div>
      </div>

      <div class="protocol-usage">
        <h3>사용 방법</h3>
        <ol>
          <li>MyDesktop을 웹서버에 업로드 (GitHub Pages, Netlify 등)</li>
          <li>위에 호스팅 URL 입력</li>
          <li>버튼을 북마크바로 드래그 (또는 코드 복사)</li>
          <li>다른 사이트에서 북마크 클릭 → 자동 추가!</li>
        </ol>
      </div>

      <div class="modal-actions">
        <button class="modal-btn secondary" id="protocol-modal-close">닫기</button>
      </div>
    </div>
  </div>

  <!-- 범용 다이얼로그 모달 -->
  <div class="modal-overlay" id="dialog-modal">
    <div class="modal dialog-modal">
      <h2 class="modal-title" id="dialog-title">확인</h2>
      <p class="dialog-message" id="dialog-message">메시지</p>
      <div class="modal-field dialog-input-field" id="dialog-input-field" style="display:none;">
        <input type="text" id="dialog-input" placeholder="">
      </div>
      <div class="modal-actions">
        <button class="modal-btn secondary" id="dialog-cancel">취소</button>
        <button class="modal-btn primary" id="dialog-confirm">확인</button>
      </div>
    </div>
  </div>

  <div id="context-menu">
    <div class="context-item" id="ctx-edit">✏️ Edit</div>
    <div class="context-item danger" id="ctx-delete">🗑️ Delete</div>
  </div>

  <div class="modal-overlay" id="shortcut-modal">
    <div class="modal">
      <h2 class="modal-title" id="modal-title">Add Shortcut</h2>
      <div class="modal-field">
        <label>Title</label>
        <input type="text" id="shortcut-title" placeholder="Google">
      </div>
      <div class="modal-field">
        <label>URL</label>
        <input type="url" id="shortcut-url" placeholder="https://google.com">
      </div>
      <div class="modal-field">
        <label>Category</label>
        <select id="shortcut-layer">
          <option value="0">Favorites</option>
          <option value="1">Social</option>
          <option value="2">Work</option>
          <option value="3">Entertainment</option>
          <option value="4">Desktop</option>
          <option value="5">Office</option>
        </select>
      </div>
      <div class="modal-field">
        <label>Icon</label>
        <input type="text" id="shortcut-icon" placeholder="si:google">
        <div class="icon-help">
          <small>💡 <strong>si:아이콘명</strong> 형식 사용 (예: si:google, si:github, si:youtube)</small><br>
          <small>📎 <a href="https://simpleicons.org" target="_blank" style="color:var(--accent)">simpleicons.org</a>에서 아이콘 이름 검색</small><br>
          <small>🔗 또는 이미지 URL 직접 입력 / 비워두면 첫글자 표시</small>
        </div>
      </div>
      <div class="modal-field">
        <label>Color</label>
        <div class="color-picker-wrapper" id="color-picker"></div>
      </div>
      <div class="modal-actions">
        <button class="modal-btn secondary" id="modal-cancel">Cancel</button>
        <button class="modal-btn danger" id="modal-delete" style="display:none;">Delete</button>
        <button class="modal-btn primary" id="modal-save">Save</button>
      </div>
    </div>
  </div>

  <!-- External Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>

  <!-- App Modules (순서 중요!) -->
  <script src="js/config.js"></script>
  <script src="js/state.js"></script>
  <script src="js/storage.js"></script>
  <script src="js/categories.js"></script>
  <script src="js/bookmarks.js"></script>
  <script src="js/space.js"></script>
  <script src="js/cards.js"></script>
  <script src="js/carousel.js"></script>
  <script src="js/sections.js"></script>
  <script src="js/lanes.js"></script>
  <script src="js/widgets.js"></script>
  <script src="js/ui.js"></script>
  <script src="js/effects.js"></script>
  <script src="js/search.js"></script>
  <script src="js/events.js"></script>
  <script src="js/main.js"></script>
</body>
</html>
